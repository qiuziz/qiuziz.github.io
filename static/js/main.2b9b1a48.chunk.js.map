{"version":3,"sources":["hooks/use-viewport.tsx","pages/dashboard/mock.ts","components/header-bar/index.tsx","components/menu/index.tsx","components/menu-left/index.tsx","pages/dashboard/index.tsx","router/index.tsx","reportWebVitals.ts","index.tsx"],"names":["viewportContext","React","createContext","ViewportProvider","children","useState","window","innerWidth","width","setWidth","innerHeight","height","setHeight","handleWindowResize","useEffect","addEventListener","removeEventListener","Provider","value","useViewport","useContext","MENU_LIST","id","key","title","url","entry","HeaderBar","className","overlay","map","menu","Item","href","placement","MenuOutlined","CustomMenu","state","openKeys","selectedKeys","defaultNodeList","handleClick","e","console","log","setState","props","onSelect","this","theme","mode","onClick","menus","item","name","Component","withRouter","SubMenu","current","onOpenChange","info","renderMenuItem","viewContent","renderSubMenu","child","length","history","pushState","handleMenuClick","menuPaths","findMenuPath","onMenuChange","nextProps","paths","slice","toString","style","ret","step","targetKey","findRet","push","pop","Header","Content","Footer","Dashboard","loading","setLoading","loader","container","document","getElementById","ReactDOM","render","position","top","left","zIndex","zoom","spinning","subAppList","location","host","activeRule","registerMicroApps","initGlobalState","routePrefix","setGlobalState","start","prefetch","sandbox","experimentalStyleIsolation","setDefaultIndicator","BasicRoute","basename","exact","path","to","component","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB"],"mappings":"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","file":"static/js/main.2b9b1a48.chunk.js","sourcesContent":["/*\n * @Author: qiuz\n * @Github: <https://github.com/qiuziz>\n * @Date:  2021-01-30 12:07:49\n * @Last Modified by: qiuz\n */\n\nimport React from 'react';\n\nexport const viewportContext = React.createContext({} as { width: number; height: number });\nexport const ViewportProvider = ({ children }: any) => {\n  // 顺带监听下高度，备用\n  const [width, setWidth] = React.useState(window.innerWidth);\n  const [height, setHeight] = React.useState(window.innerHeight);\n  const handleWindowResize = () => {\n    setWidth(window.innerWidth);\n    setHeight(window.innerHeight);\n  };\n  React.useEffect(() => {\n    window.addEventListener('resize', handleWindowResize);\n    return () => window.removeEventListener('resize', handleWindowResize);\n  }, []);\n  return <viewportContext.Provider value={{ width, height }}>{children}</viewportContext.Provider>;\n};\n\nexport const useViewport = () => {\n  const { width, height } = React.useContext(viewportContext);\n  return { width, height };\n};\n","export const MENU_LIST = [\n  {\n    id: 1,\n    key: 1,\n    title: 'Blog',\n    url: '/q/blog/',\n    entry: '/blog/',\n  },\n  {\n    id: 2,\n    key: 2,\n    title: 'React Image Map',\n    url: '/q/react-image-map/',\n    entry: '/react-image-map/',\n  },\n  {\n    id: 3,\n    key: 3,\n    title: 'Tools',\n    url: '/q/tools/',\n    entry: '/tools/',\n  },\n];\n","/*\n * @Author: qiuz\n * @Github: <https://github.com/qiuziz>\n * @Date:  2021-01-24 18:40:37\n * @Last Modified by: qiuz\n */\n\nimport { Button, Dropdown, Menu } from 'antd';\nimport { useViewport } from 'hooks';\nimport { MENU_LIST } from 'pages/dashboard/mock';\nimport React, { Component } from 'react';\nimport './index.less';\nimport { MenuOutlined } from '@ant-design/icons';\n\nconst HeaderBar = () => {\n  const { width } = useViewport();\n\n  return (\n    <div className=\"header-bar\">\n      {width <= 600 ? (\n        <Dropdown\n          overlay={() => (\n            <Menu>\n              {MENU_LIST.map((menu: any) => {\n                return (\n                  <Menu.Item key={menu.key}>\n                    <a href={menu.url}>{menu.title}</a>\n                  </Menu.Item>\n                );\n              })}\n            </Menu>\n          )}\n          placement=\"bottomRight\"\n        >\n          <MenuOutlined className=\"menu-icon\" />\n        </Dropdown>\n      ) : (\n        <ul className=\"header-ul\">\n          {MENU_LIST.map((menu: any) => {\n            return (\n              <li key={menu.key}>\n                <a href={menu.url}>{menu.title}</a>\n              </li>\n            );\n          })}\n        </ul>\n      )}\n    </div>\n  );\n};\n\nexport default HeaderBar;\n","import React from 'react';\nimport { Link, withRouter } from 'react-router-dom';\nimport { Menu } from 'antd';\n\n//此组件的意义就是将数据抽离出来，通过传递数据去渲染\nclass CustomMenu extends React.Component<any> {\n  state = {\n    openKeys: [],\n    selectedKeys: ['4'],\n    defaultNodeList: []\n  };\n\n  handleClick = (e: any) => {\n    console.log('click ', e);\n    this.setState({ selectedKeys: [`${e.key}`] });\n    this.props.onSelect(`${e.key}`);\n  };\n\n  render() {\n    const { openKeys, selectedKeys } = this.state;\n    return (\n      <Menu theme=\"dark\" mode=\"horizontal\" onClick={this.handleClick} selectedKeys={selectedKeys}>\n        {this.props.menus &&\n          this.props.menus.map((item: { key: string; name: string }) => {\n            return <Menu.Item key={item.key}>{item.name}</Menu.Item>;\n          })}\n      </Menu>\n    );\n  }\n}\n\nexport default withRouter(CustomMenu);\n","import React from 'react';\nimport { Link, withRouter } from 'react-router-dom';\nimport { Menu } from 'antd';\nconst { SubMenu } = Menu;\n\ninterface MenuField {\n  url: string;\n  key: string;\n  name: string;\n  children: MenuField[];\n}\n\n//此组件的意义就是将数据抽离出来，通过传递数据去渲染\nclass CustomMenu extends React.Component<any> {\n  state = {\n    openKeys: [],\n    selectedKeys: [this.props.current ?? '47'],\n    defaultNodeList: []\n  };\n  componentWillReceiveProps(nextProps: any) {\n    if (nextProps.menus !== this.props.menus) {\n      const paths = findMenuPath(nextProps.menus, this.state.selectedKeys[0]);\n      this.setState({ openKeys: paths.slice(0, -1).map((item) => item.key.toString()) });\n    }\n  }\n\n  onOpenChange = (openKeys: any) => {\n    console.info('openKeys:', openKeys);\n    this.setState({\n      openKeys\n    });\n  };\n  renderMenuItem = (item: any) => {\n    return (\n      <Menu.Item key={item.key} onClick={() => this.viewContent(item)}>\n        <span>{item.title}</span>\n      </Menu.Item>\n    );\n  };\n  renderSubMenu = (item: any) => {\n    return (\n      <Menu.SubMenu\n        key={item.key}\n        title={\n          <span>\n            <span>{item.title}</span>\n          </span>\n        }\n      >\n        {item.children &&\n          item.children.map((child: any) => {\n            return child.children && child.children.length > 0\n              ? this.renderSubMenu(child)\n              : this.renderMenuItem(child);\n          })}\n      </Menu.SubMenu>\n    );\n  };\n  viewContent = (item: { url: string }) => {\n    console.log(item);\n\n    item.url && window.history.pushState('', '', item.url);\n  };\n\n  handleMenuClick = (key: string | number) => {\n    this.setState({ selectedKeys: [key] });\n    const menuPaths = findMenuPath(this.props.menus, key);\n    this.props.onMenuChange(menuPaths);\n  };\n\n  render() {\n    const { openKeys, selectedKeys } = this.state;\n    return (\n      <Menu\n        mode=\"inline\"\n        onOpenChange={this.onOpenChange}\n        onClick={({ key }) => this.handleMenuClick(key)}\n        openKeys={openKeys}\n        selectedKeys={selectedKeys}\n        style={{ height: '100%' }}\n      >\n        {this.props.menus &&\n          this.props.menus.map((item: any) => {\n            return item.children && item.children.length > 0\n              ? this.renderSubMenu(item)\n              : this.renderMenuItem(item);\n          })}\n      </Menu>\n    );\n  }\n}\n\nexport const findMenuPath = (menus: MenuField[], key: string | number) => {\n  let ret: MenuField[] = [];\n  const step = (\n    menus: MenuField[],\n    targetKey: string | number,\n    menuPaths: MenuField[]\n  ): boolean => {\n    let findRet = false;\n    for (const item of menus) {\n      if (item.key == targetKey) {\n        menuPaths.push(item);\n        ret = menuPaths;\n        return true;\n      }\n      if (item.children && item.children.length) {\n        menuPaths.push(item);\n        findRet = step(item.children, targetKey, menuPaths);\n        if (findRet) {\n          break;\n        } else {\n          menuPaths.pop();\n        }\n      }\n    }\n    return findRet;\n  };\n  step(menus, key, []);\n  return ret;\n};\n\nexport default withRouter(CustomMenu);\n","/*\n * @Author: qiuz\n * @Github: <https://github.com/qiuziz>\n * @Date:  2021-01-24 18:39:02\n * @Last Modified by: qiuz\n */\n\nimport React, { useEffect, useState } from 'react';\nimport ReactDOM from 'react-dom';\nimport { BrowserRouter } from 'react-router-dom';\nimport { Layout, Spin } from 'antd';\nimport './index.less';\nimport { registerMicroApps, start, initGlobalState } from 'qiankun';\nimport { HeaderBar } from 'components';\nimport { MENU_LIST } from './mock';\nimport { useViewport } from 'hooks';\n\nconst { Header, Content, Footer } = Layout;\n\nSpin.setDefaultIndicator(\n  <div className=\"loading__box\">\n    <div className=\"loading__box-lds\">\n      <div />\n      <div />\n      <div />\n    </div>\n  </div>\n);\n\nexport default function Dashboard(props: any) {\n  const [loading, setLoading] = useState(false);\n  const { width } = useViewport();\n\n  const loader = () => {\n    const container = document.getElementById('subapp-container');\n    ReactDOM.render(\n      <>\n        <Spin\n          style={{\n            position: 'fixed',\n            top: '50%',\n            left: 'calc(50% - 100px)',\n            zIndex: 99,\n            zoom: width <= 600 ? 0.3 : 1\n          }}\n          spinning={loading}\n        />\n        <div id=\"subapp-viewport\" />\n      </>,\n      container\n    );\n  };\n\n  const subAppList: any = MENU_LIST.map((menu: any) => {\n    return {\n      name: menu.title,\n      entry: `//${process.env.NODE_ENV === 'development' ? '' : window.location.host}${menu.entry}`,\n      container: '#subapp-viewport',\n      loader,\n      activeRule: menu.url\n    };\n  });\n\n  useEffect(() => {\n    setLoading(true);\n\n    registerMicroApps(subAppList);\n\n    const { setGlobalState } = initGlobalState({\n      routePrefix: '/q'\n    });\n\n    /**\n     * Step4 启动应用\n     */\n    start({ prefetch: false, sandbox: { experimentalStyleIsolation: true } });\n  });\n\n  return (\n    <BrowserRouter>\n      <Layout className=\"tools-layout\">\n        <Header className=\"header\">\n          <div className=\"logo\">\n            <a href=\"/\">Qiuz</a>\n          </div>\n          <HeaderBar />\n        </Header>\n        <Content className=\"site-layout-background\">\n          <div id=\"subapp-container\" className=\"view\"></div>\n        </Content>\n        <Footer className=\"tools-layout-container-footer\">©2021 Created by qiuz</Footer>\n      </Layout>\n    </BrowserRouter>\n  );\n}\n","/*\n * @Author: qiuz\n * @Github: <https://github.com/qiuziz>\n * @Date:  2021-01-24 18:37:50\n * @Last Modified by: qiuz\n */\n\nimport React from 'react';\nimport { BrowserRouter, Redirect, Route, Switch } from 'react-router-dom';\nimport Dashboard from 'pages/dashboard';\nimport { ViewportProvider } from 'hooks';\n\nconst BasicRoute = () => (\n  <ViewportProvider>\n    <BrowserRouter basename={'/'}>\n      <Switch>\n        <Route exact path=\"/\" render={() => (<Redirect to=\"/q/blog/\" />)} />\n        <Route path=\"*\" component={Dashboard} />\n      </Switch>\n    </BrowserRouter>\n  </ViewportProvider>\n);\n\nexport default BasicRoute;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.less';\nimport Router from './router';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(<Router />, document.getElementById('root'));\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}